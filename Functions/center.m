function O = center(s1,s2,r1,r2,v1,v2)

if (abs(v1(1)) == 1)&&(v2(1) == 0)
    O(1) = s1(1);
    O(2) = s2(2);
    if ((v1(3) ~= 0)&&(v2(3) == 0))||((v1(3) == 0)&&(v2(3) == 0))
        O(3) = s1(3);
    elseif ((v1(3) == 0)&&(v2(3) ~= 0))
        O(3) = s2(3);
    end
    return
elseif (v1(1) == 0)&&(abs(v2(1)) == 1)
    O(1) = s2(1);
    O(2) = s1(2);
    if ((v1(3) ~= 0)&&(v2(3) == 0))||((v1(3) == 0)&&(v2(3) == 0))
        O(3) = s1(3);
    elseif ((v1(3) == 0)&&(v2(3) ~= 0))
        O(3) = s2(3);
    end
    return
end

if (r1(1) ~= 0)&&(r2(1) ~= 0)
    t1 = (s2(2)-s1(2)+r2(2)*(s1(1)-s2(1))/r2(1))/(r1(2)-r2(2)*r1(1)/r2(1));
elseif (r1(2) ~= 0)&&(r2(2) ~= 0)
    t1 = (s2(1)-s1(1)+r2(1)*(s1(2)-s2(2))/r2(2))/(r1(1)-r2(1)*r1(2)/r2(2));
elseif (r1(3) ~= 0)&&(r2(3) ~= 0)
    t1 = (s2(1)-s1(1)+r2(1)*(s1(3)-s2(3))/r2(3))/(r1(1)-r2(1)*r1(3)/r2(3));
end

O(1) = s1(1)+r1(1)*t1;
O(2) = s1(2)+r1(2)*t1;
O(3) = s1(3)+r1(3)*t1;

end